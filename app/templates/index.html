<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Resume Parser</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 font-sans flex items-center justify-center min-h-screen">
    <div class="w-full max-w-2xl mx-auto p-4">
        <div class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-white">
                AI Resume <span class="text-purple-400">Parser</span>
            </h1>
            <p class="text-gray-400 mt-4 text-lg">
                Upload resumes to instantly extract key information.
            </p>
        </div>
        <div class="flash-container mb-6">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash-message p-4 rounded-lg font-medium text-sm
                        {% if category == 'success' %} bg-green-500/10 text-green-400 border border-green-500/20 {% endif %}
                        {% if category == 'error' %} bg-red-500/10 text-red-400 border border-red-500/20 {% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        </div>
        <div class="bg-gray-800 border border-gray-700 rounded-2xl shadow-2xl p-6 md:p-8">
            <form id="upload-form" method="POST" enctype="multipart/form-data">
                <input type="file" id="resume-input" name="resumes" multiple required hidden
                       accept=".pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document">
                <label for="resume-input" id="upload-area" class="flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-gray-600 rounded-xl cursor-pointer hover:border-purple-400 hover:bg-gray-700/50 transition-colors">
                    <div class="flex flex-col items-center justify-center pt-5 pb-6">
                        <i class="fas fa-cloud-upload-alt text-5xl text-gray-500 mb-4"></i>
                        <p class="mb-2 text-lg text-gray-400"><span class="font-semibold text-purple-400">Click to upload</span> or drag and drop</p>
                        <p class="text-xs text-gray-500">PDF or DOCX files</p>
                    </div>
                </label>
                <div id="file-preview-area" class="mt-6 hidden">
                    <h3 class="font-semibold text-gray-300 mb-2">Selected Files:</h3>
                    <div id="file-list" class="space-y-2"></div>
                </div>
                <button type="submit" class="w-full mt-6 bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded-lg text-lg transition-all transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500">
                    <i class="fas fa-cogs mr-2"></i>Upload & Parse
                </button>
            </form>
        </div>
        <div class="text-center mt-8">
            <a href="{{ url_for('main.dashboard') }}" class="text-purple-400 hover:text-purple-300 font-medium transition-colors">
                <i class="fas fa-chart-pie mr-2"></i>Go to Dashboard
            </a>
        </div>
    </div>
<script>
    const uploadArea = document.getElementById('upload-area');
    const resumeInput = document.getElementById('resume-input');
    const filePreviewArea = document.getElementById('file-preview-area');
    const fileList = document.getElementById('file-list');

    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
        uploadArea.addEventListener(eventName, () => uploadArea.classList.add('border-purple-400', 'bg-gray-700/50'), false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('border-purple-400', 'bg-gray-700/50'), false);
    });

    uploadArea.addEventListener('drop', handleDrop, false);
    function handleDrop(e) {
        resumeInput.files = e.dataTransfer.files;
        handleFiles(resumeInput.files);
    }

    resumeInput.addEventListener('change', function() {
        handleFiles(this.files);
    });

    function getFileIcon(fileName) {
        const extension = fileName.split('.').pop().toLowerCase();
        if (extension === 'pdf') {
            return '<i class="fas fa-file-pdf text-red-400 mr-3"></i>';
        } else if (extension === 'docx' || extension === 'doc') {
            return '<i class="fas fa-file-word text-blue-400 mr-3"></i>';
        }
        return '<i class="fas fa-file text-gray-400 mr-3"></i>';
    }

    function handleFiles(files) {
        if (!files.length) {
            filePreviewArea.classList.add('hidden');
            return;
        }
        filePreviewArea.classList.remove('hidden');
        fileList.innerHTML = '';
        Array.from(files).forEach(file => {
            const fileSize = (file.size / 1024).toFixed(2);
            const fileItemHTML = `
                <div class="flex items-center justify-between bg-gray-700 p-2 rounded-lg">
                    <div class="flex items-center">
                        ${getFileIcon(file.name)}
                        <span class="text-sm font-medium text-gray-300">${file.name}</span>
                    </div>
                    <span class="text-xs text-gray-500">${fileSize} KB</span>
                </div>
            `;
            fileList.innerHTML += fileItemHTML;
        });
    }
</script>
</body>
</html>